# ğŸ”’ Scan de VulnÃ©rabilitÃ©s avec Nmap NSE

Le scanner IP dispose maintenant d'une fonctionnalitÃ© avancÃ©e de **dÃ©tection de vulnÃ©rabilitÃ©s** utilisant Nmap et ses scripts NSE (Nmap Scripting Engine).

## ğŸ“‹ Table des matiÃ¨res

1. [PrÃ©requis](#prÃ©requis)
2. [Installation des scripts NSE](#installation-des-scripts-nse)
3. [Utilisation](#utilisation)
4. [Scripts NSE utilisÃ©s](#scripts-nse-utilisÃ©s)
5. [InterprÃ©tation des rÃ©sultats](#interprÃ©tation-des-rÃ©sultats)
6. [Exemples de vulnÃ©rabilitÃ©s dÃ©tectÃ©es](#exemples)

---

## ğŸ› ï¸ PrÃ©requis

### 1. Installer Nmap

**Debian/Ubuntu:**
```bash
sudo apt update
sudo apt install nmap
```

**RedHat/CentOS/Fedora:**
```bash
sudo yum install nmap
# ou
sudo dnf install nmap
```

**Arch Linux:**
```bash
sudo pacman -S nmap
```

**VÃ©rifier l'installation:**
```bash
nmap --version
```

### 2. PrivilÃ¨ges root

Pour un scan complet, il est recommandÃ© d'exÃ©cuter le scanner avec `sudo`:
```bash
sudo python3 main.py
```

---

## ğŸ“¦ Installation des scripts NSE

### Script Vulners (â­ RecommandÃ©)

Le script **Vulners** interroge la base de donnÃ©es Vulners.com pour dÃ©tecter les CVEs:

```bash
# TÃ©lÃ©charger le script
cd /usr/share/nmap/scripts/
sudo wget https://raw.githubusercontent.com/vulnersCom/nmap-vulners/master/vulners.nse

# Mettre Ã  jour la base de scripts
sudo nmap --script-updatedb

# VÃ©rifier l'installation
nmap --script-help vulners
```

### Script Vulscan (Optionnel)

Le script **Vulscan** utilise des bases de donnÃ©es locales (CVE, OSVDB, etc.):

```bash
# Cloner le repository
cd /usr/share/nmap/scripts/
sudo git clone https://github.com/scipag/vulscan.git

# Mettre Ã  jour
sudo nmap --script-updatedb

# VÃ©rifier
ls -la vulscan/
```

### Scripts vuln intÃ©grÃ©s

Nmap inclut dÃ©jÃ  de nombreux scripts de vulnÃ©rabilitÃ©s:
```bash
# Lister tous les scripts vuln
ls /usr/share/nmap/scripts/ | grep vuln

# Exemples:
# - http-vuln-* (vulnÃ©rabilitÃ©s HTTP/web)
# - smb-vuln-* (vulnÃ©rabilitÃ©s SMB/Windows)
# - ftp-vuln-* (vulnÃ©rabilitÃ©s FTP)
# - ssl-* (vulnÃ©rabilitÃ©s SSL/TLS)
```

---

## ğŸš€ Utilisation

### 1. Lancer le scanner

```bash
# Avec privilÃ¨ges root (recommandÃ©)
sudo python3 main.py

# Sans root (fonctionnalitÃ©s limitÃ©es)
python3 main.py
```

### 2. Effectuer un scan rÃ©seau

1. Cliquez sur **"DÃ©marrer le Scan"**
2. Attendez que le scan rÃ©seau soit terminÃ©
3. Les hÃ´tes dÃ©tectÃ©s s'affichent dans le tableau

### 3. Scanner les vulnÃ©rabilitÃ©s

1. Cliquez sur **"ğŸ”’ Scan VulnÃ©rabilitÃ©s"**
2. Confirmez le scan (âš ï¸ peut prendre plusieurs minutes par hÃ´te)
3. Les rÃ©sultats s'affichent dans la colonne **"VulnÃ©rabilitÃ©s"**

### 4. Consulter les dÃ©tails

- **Double-cliquez** sur un hÃ´te pour voir les dÃ©tails complets
- La fenÃªtre de dÃ©tails affiche:
  - Liste complÃ¨te des vulnÃ©rabilitÃ©s
  - CVE ID
  - Score CVSS
  - Niveau de criticitÃ©
  - Port affectÃ©
  - Description

---

## ğŸ” Scripts NSE utilisÃ©s

Le scanner utilise les scripts suivants:

### 1. Script `vulners`

**Fonction:** Interroge la base Vulners.com pour les CVEs

**DÃ©tecte:**
- VulnÃ©rabilitÃ©s connues basÃ©es sur les versions de logiciels
- Score CVSS
- Exploits disponibles

**Exemple de sortie:**
```
CVE-2021-3156    10.0    Sudo Baron Samedit vulnerability
CVE-2019-15666   7.5     HTTP/2 DoS vulnerability
```

### 2. CatÃ©gorie `vuln`

**Fonction:** Ensemble de scripts de dÃ©tection spÃ©cifiques

**Scripts inclus:**
- `http-vuln-*` : VulnÃ©rabilitÃ©s web (XSS, SQLi, etc.)
- `smb-vuln-ms17-010` : EternalBlue (WannaCry)
- `smb-vuln-ms08-067` : Conficker
- `ssl-heartbleed` : Heartbleed
- `ssl-poodle` : POODLE
- Et bien d'autres...

**Exemple:**
```
smb-vuln-ms17-010: VULNERABLE
  Windows est vulnÃ©rable Ã  EternalBlue (CVE-2017-0144)
```

---

## ğŸ“Š InterprÃ©tation des rÃ©sultats

### Niveaux de criticitÃ©

Le scanner classe les vulnÃ©rabilitÃ©s selon leur score CVSS:

| CriticitÃ© | Score CVSS | Emoji | Description |
|-----------|------------|-------|-------------|
| **CRITIQUE** | 9.0 - 10.0 | ğŸ”´ | Exploitation facile, impact majeur |
| **Ã‰LEVÃ‰** | 7.0 - 8.9 | ğŸŸ  | Impact important, action urgente |
| **MOYEN** | 4.0 - 6.9 | ğŸŸ¡ | Impact modÃ©rÃ©, Ã  corriger |
| **FAIBLE** | 0.1 - 3.9 | ğŸŸ¢ | Impact limitÃ©, surveillance |

### Format d'affichage

**Dans le tableau principal:**
```
VulnÃ©rabilitÃ©s: ğŸ”´ 2 Critique(s) | ğŸŸ  5 Ã‰levÃ©(s) | ğŸŸ¡ 3 Moyen(s)
```

**Dans la fenÃªtre de dÃ©tails:**
```
ğŸ”´ CRITIQUE - CVSS: 10.0
CVE ID:      CVE-2021-3156
Port:        22 (SSH)
Description: Sudo Baron Samedit - Buffer overflow vulnerability
```

---

## ğŸ’¡ Exemples de vulnÃ©rabilitÃ©s dÃ©tectÃ©es

### Exemple 1: Serveur SSH vulnÃ©rable

```
IP: 192.168.1.50
Port: 22 (SSH)
Service: OpenSSH 7.4

VulnÃ©rabilitÃ©s:
ğŸ”´ CRITIQUE - CVSS: 10.0
CVE-2018-15473 - Ã‰numÃ©ration d'utilisateurs SSH
```

**Action recommandÃ©e:** Mettre Ã  jour OpenSSH vers la version 7.8+

### Exemple 2: Serveur Web Apache

```
IP: 192.168.1.100
Port: 80 (HTTP)
Service: Apache 2.4.29

VulnÃ©rabilitÃ©s:
ğŸŸ  Ã‰LEVÃ‰ - CVSS: 7.5
CVE-2019-0211 - Apache Privilege Escalation
```

**Action recommandÃ©e:** Mettre Ã  jour Apache vers 2.4.39+

### Exemple 3: Windows SMB (EternalBlue)

```
IP: 192.168.1.200
Port: 445 (SMB)
Service: Windows SMB

VulnÃ©rabilitÃ©s:
ğŸ”´ CRITIQUE - CVSS: 9.3
CVE-2017-0144 - MS17-010 EternalBlue
```

**Action recommandÃ©e:** Appliquer le patch Microsoft MS17-010 immÃ©diatement

---

## âš™ï¸ Configuration avancÃ©e

### Modifier les scripts utilisÃ©s

Ã‰ditez le fichier `vulnerability_scan.py`, ligne 65:
```python
nmap_cmd = [
    'nmap',
    '-sV',
    '--script', 'vulners,vuln',  # Modifier ici
    '--script-args', 'mincvss=5.0',  # Score minimum
    ...
]
```

**Options:**
- `vulners` : Base Vulners.com
- `vuln` : Tous les scripts vuln-*
- `vulscan` : Si installÃ© (base locale)
- `http-vuln-*` : VulnÃ©rabilitÃ©s HTTP uniquement
- `smb-vuln-*` : VulnÃ©rabilitÃ©s SMB uniquement

### Ajuster le timeout

Par dÃ©faut: 180 secondes (3 minutes) par hÃ´te

Modifier dans `gui.py`, ligne 866:
```python
vuln_result = scan_vulnerabilities_nmap(ip, ports=open_ports, timeout=300)  # 5 minutes
```

### Filtrer par score CVSS

Modifier le score minimum dans `vulnerability_scan.py`, ligne 67:
```python
'--script-args', 'mincvss=7.0',  # Afficher uniquement Ã‰LEVÃ‰ et CRITIQUE
```

---

## ğŸ” Bonnes pratiques

### 1. Autorisations

âš ï¸ **Important:** N'utilisez ce scanner que sur:
- Votre propre rÃ©seau
- RÃ©seaux pour lesquels vous avez l'autorisation Ã©crite
- Environnements de test/lab
- Contextes de pentest autorisÃ©s

âŒ Scanner des rÃ©seaux sans autorisation est **illÃ©gal**.

### 2. Performance

- **Temps de scan:** 2-5 minutes par hÃ´te
- **RÃ©seau /24:** ~10-20 heures pour scan complet
- **Recommandation:** Scanner uniquement les hÃ´tes critiques

### 3. Faux positifs

Les scanners peuvent gÃ©nÃ©rer des faux positifs:
- VÃ©rifiez toujours manuellement les vulnÃ©rabilitÃ©s critiques
- Testez les exploits dans un environnement contrÃ´lÃ©
- Utilisez plusieurs sources (Nmap, OpenVAS, Nessus)

---

## ğŸ›¡ï¸ Que faire avec les rÃ©sultats?

### PrioritÃ©s d'action

1. **ğŸ”´ CRITIQUE:** Action immÃ©diate
   - Isoler le systÃ¨me si possible
   - Appliquer les patches
   - VÃ©rifier si exploitation a eu lieu

2. **ğŸŸ  Ã‰LEVÃ‰:** Action dans les 48h
   - Planifier la mise Ã  jour
   - Mettre en place des mesures de mitigation

3. **ğŸŸ¡ MOYEN:** Action dans la semaine
   - Ajouter Ã  la liste des tÃ¢ches de maintenance

### Rapport de vulnÃ©rabilitÃ©s

Exportez les rÃ©sultats en CSV/JSON pour:
- Documentation
- Suivi des corrections
- Rapports de conformitÃ©
- Audit de sÃ©curitÃ©

---

## ğŸ“š Ressources supplÃ©mentaires

- [Nmap NSE Scripts](https://nmap.org/nsedoc/)
- [Vulners.com Database](https://vulners.com/)
- [CVE Details](https://www.cvedetails.com/)
- [National Vulnerability Database](https://nvd.nist.gov/)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)

---

## ğŸ› DÃ©pannage

### Nmap non trouvÃ©
```
Erreur: Nmap non installÃ©
Solution: sudo apt install nmap
```

### Scripts NSE non trouvÃ©s
```
Erreur: Script vulners introuvable
Solution: Installer le script (voir section Installation)
```

### Timeout
```
Erreur: Timeout (180s)
Solution: Augmenter le timeout ou scanner moins de ports
```

### PrivilÃ¨ges insuffisants
```
Avertissement: Certaines fonctionnalitÃ©s nÃ©cessitent root
Solution: Lancer avec sudo python3 main.py
```

---

**Votre rÃ©seau est maintenant protÃ©gÃ© grÃ¢ce Ã  la dÃ©tection avancÃ©e de vulnÃ©rabilitÃ©s!** ğŸ›¡ï¸
